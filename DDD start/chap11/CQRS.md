## 단일 모델의 단점

- 주문 내역 조회 기능을 구현하려면 여러 애그리거트에서 데이터를 가져와야 한다
- ID를 사용하여 애그리거트를 참조하는 방식을 사용하면 즉시 로징 과 같은 JPA 쿼리 관련 최적화 기능을 상요할 수 없다
- 한번의 select로 조회 화면에 필요한 데이터를 읽을수 없어 조회 속도에 문제가 생긴다

- 직접 참조하는 방식으로 연결해도 같은 연관관계에 있는 엔티티를 즉시 로딩이나 지연로딩으로 처리해야 한다

- ORM 기법은 여러 애그리거트에서 데이터를 가져와 출력하는 기능을 구현하기에 고려할 것이 많아 구현을 복잡하게 만든다
- 

## CQRS

- 상태 변겨을 위한 모델과 조회를 위한 모델을 분리한다
- CQRS를 사용하면 각 모델에 맞는 구현 기술을 선택할 수 없다
- 명령 모델은 객제 지향에 기반해서 도메인 모델을 구현하기에 적당한 JPA를 사용하여 구현하고
- 조회 모델은 DB 테이블에서 SQL로 데이터를 조회할 때 좋은 MyBatis를 사용해서 구현할 수 있다

- 명령 모델과 조회 모델이 서로 다른 데이터 저장소를 사용할 수도 있다
- 명령 모델은 트랜잭션을 지원해 주는 RDBMS를 사용하고
- 조회 모델으 ㄴ조회 성능이 좋은 메모리 기반 NoSQL을 사용할 수도 있다

- 명령 모델과 조회 모델이 서로 다른 데이터 저장소를 사용할 경우 데이터 동기화 시점에 따라 구현 방식이 달라질 수 있다
- 명령 모델에서 데이터가 바뀌자마자 변경 내역을 바로 조회 모델에 반영해야 한다면 동기 이벤트와 글로벌 트랜잭션을 사용하여 실시간으로 동기화를 할 수 있다
- 동기 이벤트와 글로벌 트랜잭션을 사용하면 전반적인 성능이 떨어지는 단점이 있다
- 서로 다른 저장소의 데이터를 특정 시간 안에만 동기화 하면 되는 경우 비동기로 데이터를 전송해도 된다

## 웹과 CQRS

- 조회 성능을 높이기 위해 다양한 기번을 사용하는 것은 CQRS를 적용하는 것과 같은 효과를 만든다
- 메모리에 캐시하는 데이터는 화면에 맞는 모양으로 변환한 데이터를캐시할 때 성능에 더 유리하다
- 조회 전용 모델을 캐시하는 것과 조회 화면에 보여질 데이터를 빠르게 읽어올 수 있도록 쿼리를 작성하는 거은 둘다 조회 속돌르 높이기 위해 쿼리를 최적화 하는 것이다
- 조회 속도를 높이기 위해 명령 도멜과 조회 모델을 구분해야 한다
- 조회 기능 때문에 명령 모델이 복잡해 지는 것을 방지할 수 있다
- 명령 모델에 관계없이 조회 기능에 특화된 구현 기법을 쉽게 적용할 수 있다

### CQRS 장단점

- 명령 모델을 구현할 때 도메인 자체에 집중할 수 있다
- 조회 성능을 위한 코드가 명령 모델에 없으므로 도메인 로직을 구현하는데 집중할 수 있다
- 조회 성능ㅇ르 향상시키는 데 유리하다
- 조회 단위로 캐시 기술을 적용할 수 있고 조회에 특화된 쿼리를 마음대로 사용할 수 있다

- 구현해야 할 코드가 더 많아진다
- 도메인이 복잡하거나 대규모 트래픽이 발생하는 서비스라면 조회 전용 모델을 만드는 것이 유지보수에 유리하다
- 도메인이 단순하거나 트래픽이 많지 않은 서비스라면 조회 전용 모델을 만들 이유가 없다

- 명령 모델과 조회 모델을 다른 구현 기술을 사용해서 구현하기 때문에
- 경우에 따라 다른 저장소를 사용하기도 한다
- 또한 데이터 동기화를 위해 메시징 시스템을 도입해야 할 수도 있다