/**
    원래있던 코드 : 금액관련 오류 있을때 메일 내용을 쌓는다
    => 보내지는 않는다

    거래일자가 오늘날짜와 같은지 판단 하여 같지 않을때 메일을 보낸다
 
    + 금액 오류만 o => 메일 안보냄
    + 거래일자가 오늘 날짜와 같지 않을때 o , 금액 오류 x => 메일 보냄
    + 거래일자가 오늘 날짜와 같지 않을때 o , 금액 오류 o => 거래일자가 오늘 날짜와 같지 않을때에 대해서만 메일을 보내야 한다
*/

if (금액관련 오류 있을때) {
    메일 내용 쌓음
}

// 메서드 내부에서 처리하면

// 오늘 날짜

// 거래 일짜
```
if (거래일짜가 오늘날짜가 아닐경우 && 금액 관련 오류 없을때) {
    메일 보냄
}
```
```
/*
          과거일자   금액 오류
          true     true => 보내면 안됨
          false     true => 보내면 안됨
          false      false => 보내면 안됨
          true       false => 보내야 됨 =>  얘는 위에 조건문에서 걸러진다
*/
if (거래일짜가 오늘날짜가 아닐경우 || 금액 관련 오류 있을때) {
    1.과거일자에 대해서 로그를 남긴다
    2. 금액 관련 오류 로그를 남긴다
}
```

```

    && : 양쪽다 true 여야 참
    || : 한쪽 이라도 true이면 참
```


1. 과거일자 인지 판단하는 것을 미리 처리해서 받는다
2. 기존 코드는 그대로 둔다
3. 메일 쌓는 메서드에 과거일자 판단 결과를 전달


### 승인
1. tb_vandb_msg 테이블에서 van에 저장된 거래내역 조회
2. tb_card_van_msg 테이블에서 van이랑 제휴맺은 신용카드 거래내역 조회
3. 없으면 tb_card_van_msg 테이블에 insert 한다
4. 승인 성공을 판단하기 위한 유효성 검사 진행
5. 가맹점 번호를 사용하여 영중소 정보조회
6. msg_cd가 0000 이면 성공
7. tb_trans , tb_trans_history , tb_card_trans 테이블에 승인 성공 원장 저장
8. msg_cd가 9999 이면 실패
9. tb_fail_trans , tb_card_fail 테이블에 승인 실패 원장 저장

### 전체 취소
1. tb_card_van_msg , tb_trans_history join 해서 van에 저장된 원승인 거래 조회
2. tb_pard_cancel_history 테이블에서 부분취소 이력이 있는지 조회
- 부분취소 이력이 있으면 전체 취소 불가
3. tb_trans 테이블의 state_cd 컬럼을 1로 update
4. tb_card_trans 테이블에서 취소 상태 변경
5. tb_trans_history , tb_cancel_history 테이블에 취소 원장 저장

### 거래대사
+ 거래내역 전문이 담겨있는 파일
+ 파일을 한줄씩 읽으면서
+ van 거래대사에 있는 거래내역이 pg에 있는지 검사한다
+ 크게크게 보고 틀 잡고
+ 상세하게 보면서 매꾸고
