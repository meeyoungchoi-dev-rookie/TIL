# 프로세스와 스레드

## 멀티 프로세싱

- 다수의 프로세서가 협력하여 일을 처리하는 것
- 컴퓨터는 한대인데 프로세서는 2개이상인 경우를 의미
- 멀티코어시스템
- CPU의 멀티코어로 하나 이상의 프로세스를 동시에 처리하는 것

![프로세스와스레드1](https://user-images.githubusercontent.com/42866800/159156521-f9d854de-4a61-4b60-920c-d233008d68ef.png)


- 하나의 프로세서가 고장 나더라도 해당 프로세서가 진행중인 작업을 다른 프로세서에서 수행되고 있기 때문에 작업이 정지 되지 않는다
- 비용 절약
- 여러 개의 프로세스가 처리해야 할 데이터의 경우 데이터를 한 공간에 저장하고 프로세스가 이를 공유한다

## 멀티 프로그래밍

- 프로세서가 입출력 작업의 종료를 기다리는 동안 하나의 프로세서에서 다른 프로그램을 수행할 수 있도록 하는 것
- 하나의 프로세스를 처리하는 과정에서 프로세서의 처리 속도와 입출력 속도 차이로 인해 입출력 처리가 완료될 때까지 기다려야 한다
- 낭비되는 시간을 줄여 다른 프로세스를 처리할 수 있도록 해준다

## 멀티 스레딩

- 하나의 프로세스가 동시에 여러 개의 스레드를 수행할 수 있도록 하는 것
- 하나의 프로세스를 다수의 스레드로 구분하여 자원을 공유
- 프로세스의 수행 능력을 향상
- 프로세스는 데이터 , 힙 , 스택 여역을 공유하지 않지만
- 스레드는 스택 영역을 제외한 데이터 , 힙 영역을 공유하기 때문에
- 메모리가 절약된다

## PCB

- 운영체제가 프로세스를 제어하기 위해 정보를 저장해 놓는 곳
- 프로세스의 상태 정보를 저장
- 프로세스 상태 관리와 문맥교환(Context Switching)을 위해 필요

- 컴퓨터를 하면서 인터넷도 하고 음악도 들을 수 있다
- 컴퓨터 운영체제가 TIME SHARING 즉 , 짧은 시간동안 번갈아서 움직이기 때문에 동시에 처리하는 것 처럼 느껴지는 것이다
- 즉 , 프로세스를 교체하면서 다른 프로세스의 정보를 불러온다
- 프로세스의 이전 작업에 대한 내용을 기억하고 있게 된다
- 왜?
- 프로세스 단위로 정보를 저장해 주는 BLOCK이 있기 때문
- 운영체제가 프로세스에 대한 중요 정보를 저장하는 곳을 PCB라고 한다

## Context Switch

- CPU가 현재 작업 중인 프로세스에서 다른 프로세스로 넘어갈때
- 지금까지의 프로세스 상태를 저장하고 새 프로세스에 저장상태를 다시 적재

## Context Switch가 발생하는 경우

- 멀티태스킹 , 인터럽트 핸들링 , 사용자 모드와 커널 모드 간 전환시 발생한다
- `멀티태스킹`
    - 실행 가능한 프로세스들이 운영체제의 스케줄러에 의해 번갈아가며 수행되는 것
    - 프로세스가 번갈아 가며 CPU를 할당받을때 Context Switching 한다

- 인터럽트 핸들링
    - 인터럽트 - 컴퓨터 시스템에서 예외 상황이 발생했을때 cpu에게 알려 처리할 수 있도록 하는 것
    - 인터럽트가 발생하면 Context Switching한다
    
- 사용자와 커널 모드 전환
    - 사용자와 커널 모드 전환시 Context Switch가 운영체제에 따라 발생할 수 있다

## Context Switching 과정
![프로세스와스레드2](https://user-images.githubusercontent.com/42866800/159156531-6191c73a-4933-4d71-a96c-0bd48d38a412.png)


```
1. 요청 발생 : 인터럽트 또는 트랩에 의한 요청이 발생
2. PCB에 저장 : 운영체제는 현재 실행중인 프로세스의 정보를 PCB에 저장
3. CPU 할당 : 운영체제는 다음 프로세스의 정보를 PCB에서 가져와 CPU 할당
```